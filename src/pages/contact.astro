---
// src/pages/contact.astro
import BaseLayout from "@/layouts/BaseLayout.astro";
// Note: The original index page had commented-out imports for UI components.
// If the form styling relies on these or specific CSS classes from them,
// they might need to be re-imported or the classes adjusted.
// For now, we'll use the existing HTML structure and classes.
---

<BaseLayout
  title="Contact Us | Lethbridge Drone Services | Coalbanks Creative"
  description="Get in touch with Coalbanks Creative for professional drone videography and photography services in Lethbridge, Alberta. Request a quote for your project today."
>
  <main class="flex flex-col gap-y-20 md:gap-y-32 overflow-x-hidden">
    <section id="contact" class="container py-16 md:py-24">
      <h1 class="font-heading text-3xl font-bold text-center mb-12">Let's Chat About Your Project</h1> {/* Changed h2 to h1 for page title */}
      <p class="text-lg text-muted-foreground leading-relaxed mb-8 max-w-xl mx-auto text-center">
        Have an idea buzzing around for some awesome drone footage? Or maybe just curious how aerial views could boost your Lethbridge business? We'd love to hear from you! Fill out the quick form below, give us a call, or shoot us an email â€“ we're happy to answer questions and provide a no-obligation quote.
      </p>
      <form id="contact-form" method="POST" action="/api/submit" class="max-w-xl mx-auto grid gap-6">
        <div class="grid gap-2">
          <label for="name" class="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-50">Name</label>
          <input
            type="text"
            id="name"
            name="name"
            placeholder="Your Name"
            required
            class="border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex h-9 w-full rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:cursor-not-allowed disabled:opacity-50 md:text-sm"
          />
        </div>
        <div class="grid gap-2">
          <label for="email" class="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-50">Email</label>
          <input
            type="email"
            id="email"
            name="email"
            placeholder="your@email.com"
            required
            class="border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex h-9 w-full rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:cursor-not-allowed disabled:opacity-50 md:text-sm"
          />
        </div>
        <div class="grid gap-2">
          <label for="phone" class="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-50">Phone (Optional)</label>
          <input
            type="tel"
            id="phone"
            name="phone"
            placeholder="Your Phone Number"
            class="border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex h-9 w-full rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:cursor-not-allowed disabled:opacity-50 md:text-sm"
          />
        </div>
        <div class="grid gap-2">
          <label for="service-needed" class="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-50">Type of Service Needed (Optional)</label>
          <select
            id="service-needed"
            name="service-needed"
            class="border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex h-9 w-full rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:cursor-not-allowed disabled:opacity-50 md:text-sm"
          >
            <option value="" disabled selected>Select a service...</option>
            <option value="Elevate Your Listings">Elevate Your Listings</option>
            <option value="Wow Factor Marketing & Brand Videos">Wow Factor Marketing & Brand Videos</option>
            <option value="Dynamic Event Coverage">Dynamic Event Coverage</option>
            <option value="Construction Progress From Above">Construction Progress From Above</option>
            <option value="Precision Mapping & Data">Precision Mapping & Data</option>
            <option value="Smarter Farming Aerials">Smarter Farming Aerials</option>
            <option value="Other">Other</option>
          </select>
        </div>
        <div class="grid gap-2">
          <label for="project-location" class="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-50">Project Location (Approximate, Optional)</label>
          <input
            type="text"
            id="project-location"
            name="project-location"
            placeholder="e.g., Lethbridge North, Taber Area"
            class="border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex h-9 w-full rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:cursor-not-allowed disabled:opacity-50 md:text-sm"
          />
        </div>
        <div class="grid gap-2">
          <label for="message" class="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-50">Message / Project Details</label>
          <textarea
            id="message"
            name="message"
            placeholder="Tell us a bit about your project or question..."
            rows={5}
            required
            class="border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm"
          ></textarea>
        </div>
        <div id="form-status" class="text-sm font-medium"></div> {/* Element to display success/error messages */}
        <button
          type="submit"
          id="submit-button"
          class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 h-10 rounded-md px-8 bg-accent text-accent-foreground hover:bg-accent/90"
        >
          Request My Quote
        </button>
      </form>
    </section>

    {/* Add script for form submission handling */}
    <script>
      const form = document.getElementById('contact-form') as HTMLFormElement;
      const statusDiv = document.getElementById('form-status') as HTMLDivElement;
      const submitButton = document.getElementById('submit-button') as HTMLButtonElement;

      form.addEventListener('submit', async (event) => {
        event.preventDefault();
        submitButton.disabled = true;
        submitButton.textContent = 'Sending...';
        statusDiv.textContent = ''; // Clear previous status

        const formData = new FormData(form);
        const data = Object.fromEntries(formData.entries());

        try {
          const response = await fetch('/api/submit', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify(data),
          });

          if (response.ok) {
            const result = await response.json();
            statusDiv.textContent = 'Success! Your message has been sent.';
            statusDiv.style.color = 'green';
            form.reset(); // Clear the form
          } else {
            const errorResult = await response.json();
            statusDiv.textContent = `Error: ${errorResult.message || 'Failed to send message.'}`;
            statusDiv.style.color = 'red';
          }
        } catch (error) {
          console.error('Form submission error:', error);
          statusDiv.textContent = 'An unexpected error occurred. Please try again later.';
          statusDiv.style.color = 'red';
        } finally {
          submitButton.disabled = false;
          submitButton.textContent = 'Request My Quote';
        }
      });
    </script>

  </main>
</BaseLayout>

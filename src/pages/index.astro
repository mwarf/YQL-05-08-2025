---
// src/pages/index.astro
import BaseLayout from "@/layouts/BaseLayout.astro";
// import { buttonVariants } from "@/components/ui/button"; // Removed unused import
// import { Label } from "@/components/ui/label"; // Comment out import
// import { Input } from "@/components/ui/input"; // Remove Input import
// import { Textarea } from "@/components/ui/textarea"; // Remove Textarea import
import { getCollection, type CollectionEntry } from "astro:content"; // Import content collection functions
import BlogPostPreview from "@/components/BlogPostPreview.astro"; // Import the preview component
// import { Image, getImage } from "astro:assets"; // Removed Astro Assets import
import { FeaturedItemsCarousel } from "@/components/blocks/FeaturedItemsCarousel"; // Import the new carousel
import WistiaPlayer from "@/components/WistiaPlayer.astro"; // Import the Wistia player component
import HeroWithVideoContent from "@/components/blocks/HeroWithVideoContent.tsx"; // Import the new Hero component
import { ClientLogos } from "@/components/blocks/ClientLogos"; // Import the ClientLogos component

// Removed image imports for carousel - using direct paths now
// import ftllImage from "@/images/project-images/FTLL.jpg";
// import discGolfImage from "@/images/project-images/disc-golf.jpeg";
// import pepsicoImage from "@/images/project-images/pepsico-project.jpg";
// import mdTaberImage from "@/images/project-images/md-taber.jpg";
// import postVisionImage from "@/images/project-images/post-vision-video.jpg";
// import pgaImage from "@/images/project-images/this-is-us-pga.jpg";
// import smridImage from "@/images/project-images/SMRID-project.jpg";
// import prairieQueenImage from "@/images/project-images/prairie-queen.jpg";
// import huckfestImage from "@/images/project-images/huckfest.png";
// import albertaEnergyImage from "@/images/project-images/alberta-energy.jpg";

// Import SVG logos - Reverted (Keep this comment block as is)
// import cityLogoUrl from '@/images/logos/city-of-lethbridge-logo.svg';
// import uoflLogoUrl from '@/images/logos/uofl_reverse.svg';
// import pepsicoLogoUrl from '@/images/logos/pepsico-logo-horizontal-reverse.svg';
// import snapshotLogoUrl from '@/images/logos/snapshot-studios-reverse.svg';
// import stantecLogoUrl from '@/images/logos/stantec-consulting-reverse-horizontal.svg';
// import pgaLogoUrl from '@/images/logos/pga-horizontal-reverse.svg';
// import galtLogoUrl from '@/images/logos/galt-horizontal-reverse.svg';
// import castleLogoUrl from '@/images/logos/castle-mountain-logo-reverse.svg';
// import mdTaberLogoUrl from '@/images/logos/md-taber-logo-reverse.svg';
// import sumusLogoUrl from '@/images/logos/sumus-horizontal-reverse.svg';
// import storyhiveLogoUrl from '@/images/logos/storyhive-reverse-logo.svg';

// Fetch featured blog posts
type BlogPost = CollectionEntry<"blog">;
const featuredPosts = (await getCollection("blog"))
  .filter((post: BlogPost) => post.data.featured) // Keep first filter
  .sort(
    (a: BlogPost, b: BlogPost) =>
      b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
  ) // Keep first sort
  .slice(0, 3); // Get latest 3 featured

// Removed getImage processing - using direct paths to pre-optimized images

// Prepare data for the FeaturedItemsCarousel with direct image paths
const carouselItems = [
  // Community/Local Pride
  {
    id: "carousel-item-1",
    title: "For the Love of Lethbridge",
    summary:
      "We were proud to capture the essence of Lethbridge with stunning drone footage for the 'For the Love of Lethbridge' campaign, a heartfelt tribute to the region's beauty and charm. Our aerial visuals showcased the city's vibrant landscapes and community spirit, highlighting why Lethbridge is a wonderful place to live and work. By combining breathtaking views with a compelling narrative, we helped create a love letter to the region that resonates with both locals and newcomers alike.",
    url: "https://youtu.be/-zaqFf4qhhg?si=lU31gGinZHoiVLLb",
    linkText: "View Video",
    alt: "Aerial view of Lethbridge river valley and high level bridge.",
    imageSrc: "/optimized-images/project-images/FTLL.webp", // Direct path
  },
  {
    id: "carousel-item-9",
    title: "M.D. of Taber 70th Anniversary",
    summary:
      "We captured drone footage for the M.D. of Taber’s 70th anniversary video, showcasing local businesses, tourism spots, and infrastructure from above.\n\nThese aerial views celebrate the community’s growth and rich history, highlighting its vibrant spirit.\n\nIt was a privilege to contribute to this meaningful tribute, helping tell Taber’s story.",
    url: "https://www.youtube.com/watch?v=_9BMIcHVSv4&t=17s",
    linkText: "View Video",
    alt: "Drone shot of MD of Taber administration building.", // Updated Alt Text
    imageSrc: "/optimized-images/project-images/md-taber.webp", // Direct path
  },
  {
    id: "carousel-item-10",
    title: "Post Vision Video",
    summary:
      "For Sumus' Post project, we captured drone footage for their vision video, showcasing the transformation of a historic Lethbridge building into a modern workspace.\n\nThis redevelopment unites legacy and innovation, creating new opportunities for local businesses.\n\nOur aerial perspectives help bring this community-focused initiative to life.",
    url: "https://www.youtube.com/watch?v=sSvVNeYLscw&t=10s",
    linkText: "View Video",
    alt: "Aerial view of the Post building in downtown Lethbridge.", // Updated Alt Text
    imageSrc: "/optimized-images/project-images/post-vision-video.webp", // Direct path
  },
  // Agriculture/Industry
  {
    id: "carousel-item-5",
    title: "The Story of Us - PGA",
    summary:
      "We showcased the heart and dedication of Alberta's potato-growing families. From sweeping farmland vistas to close-up shots of innovative technology in action, our aerial visuals highlighted the challenges and triumphs of producing safe, sustainable food. Through our lens, we helped tell a story of tradition, community, and progress in Alberta's potato industry.",
    url: "https://youtu.be/UUfeCmwQMIw?si=i7cealcuNi9l2JUm",
    linkText: "View Video",
    alt: "Potato harvesting machinery in a field for PGA Alberta.",
    imageSrc: "/optimized-images/project-images/this-is-us-pga.webp", // Direct path
  },
  {
    id: "carousel-item-3",
    title: "Pepsi Sustainable Agriculture",
    summary:
      "We were proud to contribute drone footage for PepsiCo’s feature on The Perry Farm in Chin, Alberta, showcasing their groundbreaking initiatives in regenerative agriculture and sustainability. Our aerial visuals captured the beauty of the farm and the innovative practices, from renewable energy projects to sustainable potato production. Through our lens, we helped highlight PepsiCo’s commitment to environmental stewardship and the Perry family’s leadership in sustainable farming.",
    url: "#",
    linkText: "Read More",
    alt: "Aerial shot of farm equipment working in a field for PepsiCo.",
    imageSrc: "/optimized-images/project-images/pepsico-project.webp", // Direct path
  },
  {
    id: "carousel-item-7",
    title: "SMRID Infrastructure",
    summary:
      "We captured drone footage for SMRID, showcasing their infrastructure and Chinn chute expansion. It highlights their vital role in Southern Alberta's agriculture and environment. Now featured on their website, it tells their story in a simple and clear way.",
    url: "https://smrid.com/",
    linkText: "Visit Website",
    alt: "Drone view of SMRID irrigation canal infrastructure.", // Updated Alt Text
    imageSrc: "/optimized-images/project-images/SMRID-project.webp", // Direct path
  },
  // Events/Entertainment
  {
    id: "carousel-item-4",
    title: "Francheska Prairie Queen",
    summary:
      "We were honored to collaborate with Snap Studios on 'Francheska: Prairie Queen,' capturing stunning drone footage that complemented the inspiring story of Francis Yutrago's journey to drag superstardom. Our aerial visuals added depth and beauty to this documentary, highlighting the contrasts between Kiko's small-town life and his vibrant stage presence. By combining our drone expertise with the film's powerful narrative, we helped bring this unforgettable story to life.",
    url: "https://watch.telusoriginals.com/view/francheska-prairie-queen",
    linkText: "View Video",
    alt: "Promotional image for the documentary Francheska Prairie Queen.",
    imageSrc: "/optimized-images/project-images/prairie-queen.webp", // Direct path
  },
  {
    id: "carousel-item-6",
    title: "Castle Mountain Huckfest",
    summary:
      "We contributed drone footage for the Castle Mountain Huckfest recap video, capturing a bird's-eye view of the action and stunning mountain scenery. Our high-quality aerials showcased the energy and adventure of this amazing event, bringing Huckfest to life in a way that's both exhilarating and authentic.",
    url: "https://www.youtube.com/watch?v=Ze6HysY5ERw",
    linkText: "View Video",
    alt: "Aerial view of skiers and snowboarders at Huckfest Castle Mountain.",
    imageSrc: "/optimized-images/project-images/huckfest.webp", // Direct path (Note: source was .png)
  },
  // Specific Services/Other
  {
    id: "carousel-item-2",
    title: "Aperture Park Disc Golf",
    summary:
      "We created detailed mapping and signage images for the University of Lethbridge's Aperture disc golf course, enhancing player experience on this scenic 18-hole route. Our work helped ensure visitors could fully enjoy the course and surrounding foliage.", // Shortened slightly
    url: "#",
    linkText: "Read More",
    alt: "Drone view of Aperture Park Disc Golf course map sign.",
    imageSrc: "/optimized-images/project-images/disc-golf.webp", // Direct path (Note: source was .jpeg)
  },
  {
    id: "carousel-item-8",
    title: "The Future of Energy is Here",
    summary:
      "We showcased solar and wind sites across Vauxhall, Raymond, Pincher Creek, and Magrath in this video, produced by Frame30 Productions, shares Alberta’s inspiring energy story with the world.",
    url: "https://www.youtube.com/watch?v=QqSA8eWww7I",
    linkText: "View Video",
    alt: "Drone shot of wind turbines in Southern Alberta.", // Updated Alt Text
    imageSrc: "/optimized-images/project-images/alberta-energy.webp", // Direct path
  },
];
---

<BaseLayout
  title="Your Lethbridge Drone Team | Stunning Aerial Views | Coalbanks Creative"
  description="Looking for great drone shots in Lethbridge & Southern Alberta? Coalbanks Creative offers friendly aerial photography & video for real estate, events, construction, and more. Let's capture a new perspective! Get your free quote."
>
  <main class="flex flex-col gap-y-16 md:gap-y-24 overflow-x-hidden"> {/* Reduced gap */}
    {/* New Hero Section */}
    <section id="hero" class="relative min-h-screen flex items-center justify-center overflow-hidden"> {/* Added relative and overflow-hidden */}
      {/* Add topography SVG background */}
      <div class="absolute inset-0 -z-10 size-full bg-[url('/images/assets/topography.svg')] bg-repeat opacity-30 dark:invert" /> {/* Increased opacity to 30 for light mode contrast */}
      {/* Added bg-background/80 for contrast overlay */}
      <div class="max-w-screen-xl w-full mx-auto grid lg:grid-cols-2 gap-12 px-6 py-12 z-10 bg-background/80 rounded-lg shadow-lg"> {/* Added overlay, rounded, shadow */}
        <HeroWithVideoContent
          client:visible
          badgeText="Serving Southern Alberta"
          title="Your Project, Elevated"
          description="See your Southern Alberta project soar with Coalbanks Creative! As your local Lethbridge drone experts, we provide high-quality aerial photos and video you can trust. We partner with businesses like yours – in agriculture, construction, real estate, marketing, and events – to capture unique viewpoints that tell your story beautifully and effectively. Ready for a better view?"
          button1Text="Get Your Free Quote"
          button1Link="/contact"
          button2Text="Explore Our Work"
          button2Link="#featured-work"
        />
         <div class="w-full rounded-xl flex items-center justify-center overflow-hidden"> {/* Removed aspect-video and bg-muted */}
            {/* Embed Wistia Player Directly - Set preload="metadata" */}
            <WistiaPlayer mediaId="2cx9e0koe3" preload="metadata" />
         </div>
       </div>
     </section>

    <!-- Featured Items Carousel Section -->
    <section id="featured-work"> {/* Wrap the component in a section with the ID */}
      <FeaturedItemsCarousel heading="Our Work" items={carouselItems} client:load /> {/* Removed id from component, Removed headingClassName prop */}
    </section>

    {/* Client Logos Section - Moved Here */}
    <ClientLogos client:visible />

    {/* Temporarily comment out Featured Blog Posts section AGAIN to isolate error */}

    {featuredPosts.length > 0 && (
      <section id="featured-blog" class="container py-16 md:py-24">
        <h2 class="font-heading text-3xl font-bold text-center mb-4 tracking-tight">Fresh from the Blog: Drone Tips & Insights</h2> {/* Add tracking-tight */}
        {/* Added intro line */}
        <p class="text-center text-lg text-muted-foreground mb-12 max-w-2xl mx-auto">
          Curious about drones or need some helpful tips? Dive into our latest articles:
        </p>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
          {/* Pass headingLevel="h3" for correct semantics */}
          {featuredPosts.map((post: BlogPost) => (
            <BlogPostPreview post={post} headingLevel="h3" />
          ))}
        </div>
        <div class="text-center mt-12">
          <a href="/blog" class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground h-9 px-4 py-2">
            See More Blog Posts
          </a>
        </div>
      </section>
    )}
    
    {/* Removed commented-out contact form script */}

  </main>
</BaseLayout>
